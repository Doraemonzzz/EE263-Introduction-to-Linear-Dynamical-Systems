data = [0.78709688;0.96905331;0.41167342;0.88508911;0.24201306;0.55089267;0.58933998;0.57115634;0.44922845;0.76860948;0.79056507;1.00272665;0.41442769;0.89287459;0.23239430;0.54503755;0.56935736;0.56968959;0.47266243;0.75532254;0.77348250;1.02832271;0.44602439;0.91337818;0.25792412;0.49404192;0.52173355;0.60409253;0.47788252;0.68984463;0.77086226;1.06040214;0.45694039;0.92553384;0.25544298;0.45504476;0.47740151;0.62323266;0.50685398;0.63650927;0.61664490;0.77727616;0.51435451;1.01229352;0.48160768;0.41346536;0.53525762;0.80164184;0.24012799;0.44862758;0.63940591;0.89052176;0.54039083;1.02443067;0.45393501;0.35279869;0.44564719;0.79472418;0.32709931;0.40080508;0.69140978;0.83285044;0.44727319;0.93715699;0.36746143;0.50668301;0.59104969;0.68436463;0.31942828;0.63450299;0.80968190;1.09571415;0.43053816;0.90360332;0.21010874;0.48855634;0.49454357;0.56720977;0.54212886;0.72271216;0.81600768;1.00335678;0.39484834;0.85684948;0.19523953;0.58041049;0.59762084;0.53160699;0.49118686;0.83174245;0.69688709;0.86070564;0.45779910;0.93829274;0.35314861;0.49890169;0.57979127;0.67732153;0.34255257;0.63402272;-0.04682973;-0.12023443;0.00114182;0.01086040;0.06219819;0.02167949;0.05731579;0.04198386;-0.10059495;-0.01763051;-0.09852836;-0.11204157;0.05980795;0.07380380;0.13838845;-0.08267729;-0.02960446;0.13499772;-0.12020678;-0.18878570;0.13428182;0.18935796;-0.06928960;-0.08806728;-0.18868798;0.07939701;0.00293550;-0.17141563;0.18917354;0.22006755;-0.05948666;-0.08992924;0.03379226;0.03833822;0.08744660;-0.02985557;0.00174139;0.07305302;-0.09092357;-0.09556697;-0.08060336;-0.17480593;0.02044230;0.03177639;0.11282140;0.00787650;0.06110398;0.08205072;-0.15538668;-0.06938111;0.08633917;0.09132547;-0.05574731;-0.06730018;-0.12204475;0.07870764;0.03358184;-0.12048006;0.10120182;0.17325939;-0.02191521;-0.02713617;0.01138444;0.01533895;0.02989870;-0.01633915;-0.00360251;0.02945469;-0.02758989;-0.03876867;-0.00818896;-0.08585514;-0.02433530;-0.02103215;0.00882316;0.06274525;0.07797048;-0.01442271;-0.06073367;0.06515459;-0.00560481;0.00239717;0.00388602;0.00653057;0.00601756;-0.01258464;-0.00914254;0.01107398;0.00063004;-0.01763323;0.06907106;0.12170551;-0.02774359;-0.03705594;-0.09726484;0.01878113;-0.02316802;-0.07980578;0.11422865;0.08868735;-0.06808248;-0.09460161;0.03258265;0.04431174;0.09339531;-0.04143067;-0.00107764;0.08787045;-0.09320623;-0.11051687;-0.03254553;-0.00254462;0.03035231;0.03590476;0.04496365;-0.05856920;-0.04440476;0.05655053;-0.01536343;-0.09661821;-0.01669851;-0.05268912;0.00370402;0.00230487;0.02714110;0.01642378;0.02643773;0.01056200;-0.04643655;-0.00173527;-0.03727045;-0.11645568;-0.00234982;0.00254805;0.05230354;0.03598376;0.06456616;0.02571257;-0.09652540;0.00403219;-0.00360078;-0.01868129;-0.01047670;-0.00440202;-0.00077592;0.01048044;0.01857391;0.00117056;-0.00999097;0.01434204;0.06655873;0.12368571;-0.02974889;-0.03491909;-0.09761478;0.01245245;-0.02571419;-0.07388855;0.11746689;0.08320185;0.04117949;0.14853304;0.01081134;0.00440008;-0.05663537;-0.05784386;-0.09258318;-0.02185188;0.11946623;-0.02593754;-0.02098292;0.01066984;0.03449299;0.03029100;0.03709936;-0.04929681;-0.04780888;0.03896255;-0.00761889;-0.08371235;-0.03899492;-0.08257506;0.00310201;0.01402987;0.04897232;0.00224801;0.03208399;0.04156196;-0.06950786;-0.02944649;0.03886698;-0.00236143;-0.04603117;-0.04689086;-0.05968901;0.07511336;0.06342279;-0.06811872;0.01920671;0.12744952;0.00998923;0.01651496;-0.00647903;-0.00630166;-0.01564702;0.00377240;-0.00095494;-0.01158008;0.01697970;0.01566427;-0.07603411;-0.10903899;0.03539902;0.04836818;0.10441658;-0.04319791;0.00216858;0.09694907;-0.10651585;-0.12009979;-0.06930372;-0.08108918;0.04824248;0.05301740;0.10256124;-0.05631438;-0.02273693;0.09307302;-0.09011848;-0.13619101;-0.08157547;-0.04140324;0.07413791;0.08067960;0.12010206;-0.11532927;-0.08151074;0.12818927;-0.06832690;-0.21463598;-0.00054708;0.06260177;0.02384280;0.02265983;0.00245762;-0.05793878;-0.06617410;0.02204072;0.04164614;-0.06725187;-0.05166320;-0.12571499;0.00374153;0.01439414;0.06873166;0.01762055;0.05605500;0.04866572;-0.10628559;-0.02662783;0.04465613;0.09555505;-0.01627084;-0.01927204;-0.06589828;-0.00304123;-0.02977406;-0.04518403;0.08779242;0.04347214;0.04471183;0.00963437;-0.04793558;-0.04948036;-0.06801552;0.07516609;0.05980538;-0.07427069;0.03011658;0.13333217;-0.00710163;0.02796064;0.02407463;0.01972980;0.01572313;-0.03893279;-0.04364931;0.02085547;0.01179265;-0.05658767;0.05133528;0.10007250;-0.01607317;-0.02389262;-0.07130313;0.00518217;-0.02785401;-0.05622863;0.09077646;0.05504364;-0.07867485;-0.03433042;0.07178707;0.07929369;0.11462942;-0.11626051;-0.08336068;0.12580260;-0.06111497;-0.21138690;-0.07679660;-0.03672180;0.07038305;0.07667907;0.11293802;-0.11061568;-0.07893775;0.12147915;-0.06267015;-0.20421779;-0.02936413;0.06242109;0.05888061;0.05718822;0.04788496;-0.11192797;-0.11217605;0.07163703;0.02517682;-0.16106548;0.06031432;0.10063026;-0.03241702;-0.03599921;-0.08966575;0.02173517;-0.01061137;-0.07062223;0.09947309;0.08837710;0.00510599;-0.02744847;-0.02362213;-0.01774309;-0.01419448;0.03478901;0.04124225;-0.01689978;-0.01133409;0.05132967;0.02557864;0.03512840;-0.01555387;-0.01765137;-0.03747540;0.01604642;0.00276830;-0.03265073;0.03655830;0.04455837;-0.06450296;-0.10572192;0.03463090;0.03896505;0.09538484;-0.02494439;0.00982212;0.07628339;-0.10468440;-0.09588849;-0.09352181;-0.14044304;0.04320740;0.05781505;0.12978152;-0.04744982;0.00803676;0.11679657;-0.13640911;-0.14276345;-0.06496135;-0.04214487;0.05524725;0.06091621;0.09511064;-0.08348750;-0.05509925;0.09905239;-0.06033242;-0.16100247;-0.05338768;-0.10444318;0.01621027;0.02461778;0.07386720;-0.00504097;0.02957872;0.05841057;-0.09444147;-0.05655373;-0.03440515;-0.12380159;-0.01173547;-0.00433582;0.04521074;0.04815189;0.07876309;0.01880358;-0.09799617;0.02367904;-0.02279615;-0.08408018;-0.00940044;-0.00382894;0.02925277;0.03379845;0.05485601;0.01190474;-0.06580763;0.01854818;-0.07843869;-0.16781552;0.02024797;0.03159543;0.10947748;0.00559430;0.05737118;0.08069956;-0.14938997;-0.06951043;0.00033185;0.00796102;0.01145680;0.00482066;0.00638352;-0.00690989;-0.01322298;0.00069600;0.00039540;-0.01459147;0.04851717;0.11035521;-0.00667657;-0.01630988;-0.06497614;-0.00953325;-0.04441550;-0.04824944;0.09482845;0.03331940;-0.06250791;-0.11744428;0.01960774;0.03020861;0.08573391;-0.01026431;0.03029407;0.07020515;-0.10666078;-0.07031778;-0.08285109;-0.13724724;0.03564947;0.04728561;0.11624217;-0.03044401;0.01920342;0.09880996;-0.13066338;-0.11480740;-0.05723751;-0.10228942;0.02568456;0.03107897;0.08299020;-0.01436609;0.01872312;0.06513742;-0.09747598;-0.07465140;0.03868934;-0.04216040;-0.06300746;-0.06133374;-0.06227194;0.11104213;0.10615403;-0.08083534;-0.00615345;0.17051746;0.06006016;0.12853125;-0.01246063;-0.02335705;-0.08154675;-0.00441661;-0.04581897;-0.06226034;0.11266787;0.05068864;-0.00622477;-0.04690138;-0.01071251;-0.00926563;0.00791797;0.03097090;0.03951299;-0.00493230;-0.03442924;0.02951084;0.00456779;-0.07627135;-0.03836578;-0.03353044;-0.01257753;0.07807313;0.08966820;-0.03285144;-0.04590067;0.09842570;-0.04177943;-0.06946180;0.02492264;0.02566793;0.06390501;-0.01535691;0.00564195;0.04862460;-0.07010843;-0.06343354;-0.07373157;-0.13035248;0.02236458;0.03747780;0.09848440;-0.01941731;0.02952077;0.08616962;-0.11814853;-0.08837154;0.01372935;0.06115361;0.00697913;0.00530240;-0.01928685;-0.02982916;-0.04243074;-0.00321721;0.04816264;-0.02004414;-0.04854175;-0.03722018;0.04216976;0.04432262;0.07318633;-0.05727806;-0.03703704;0.07160811;-0.05065192;-0.11679681;-0.03107783;-0.00521257;0.03504269;0.03523293;0.04819682;-0.05363378;-0.04383517;0.05193692;-0.02061440;-0.09519550;-0.04900642;0.02851261;0.06837165;0.06833716;0.07657175;-0.11795157;-0.10714008;0.09435560;-0.00760871;-0.18812619;0.05141734;0.12466451;-0.00181392;-0.01392043;-0.06685386;-0.01719462;-0.05658686;-0.04891631;0.10428160;0.02526155;-0.09796101;-0.10135443;0.06328160;0.07693559;0.13792290;-0.09133361;-0.03996968;0.13758878;-0.11284206;-0.19828295;-0.02074325;-0.03935096;0.00361270;0.00914409;0.02636956;-0.00297188;0.01213090;0.02360782;-0.03406331;-0.02066977;0.01343119;-0.05430881;-0.03888295;-0.03586699;-0.02437525;0.07469199;0.07965270;-0.04106415;-0.02738932;0.10259885;0.01297316;0.06746561;0.01968563;0.01099478;-0.01082779;-0.03730236;-0.05600473;-0.00128696;0.04652791;-0.03690120;-0.07984511;-0.07260860;0.05609795;0.06644513;0.11328537;-0.08356350;-0.04351013;0.11538598;-0.08573992;-0.17274743;0.07689792;0.16083997;-0.02338666;-0.03285847;-0.10905603;-0.00206747;-0.05107698;-0.08000912;0.14524066;0.07378513;-0.12854107;-0.19089354;0.06539342;0.08163194;0.18235506;-0.06733475;0.00562626;0.16042375;-0.18905491;-0.20275709;0.00435292;-0.02126321;-0.01733896;-0.01382974;-0.01053629;0.02764865;0.03170256;-0.01400589;-0.00938557;0.03986896;-0.08865136;-0.11906696;0.04855960;0.06039746;0.12518327;-0.05784204;-0.00851475;0.11507274;-0.12125930;-0.15200985;0.06522532;0.11817288;-0.02550979;-0.03399165;-0.09215158;0.01480363;-0.02494845;-0.07418792;0.11033704;0.08077917;-0.04207120;-0.09131191;-0.00027817;0.01359448;0.05067170;0.00453898;0.03864691;0.04453658;-0.07486874;-0.02713516;-0.01829204;0.05876430;0.04559893;0.04303574;0.03150921;-0.08784861;-0.09156856;0.05107764;0.02810974;-0.12240975;0.01842589;0.07776672;0.01232538;0.00683925;-0.02256991;-0.03626956;-0.05523811;-0.00649195;0.05913236;-0.02615101;0.01072902;-0.09116391;-0.05033875;-0.04587665;-0.02188382;0.10315534;0.11443801;-0.04865356;-0.05298839;0.13323577;0.07396056;0.15196850;-0.02320374;-0.03248073;-0.10473460;0.00048126;-0.04646393;-0.07791973;0.13769234;0.07357235;-0.06058372;-0.07364237;0.03446204;0.04356093;0.08455498;-0.04650091;-0.01291012;0.08149560;-0.07677758;-0.11065749;-0.04268188;-0.10092553;0.00990316;0.01447832;0.06116399;0.01169914;0.03974770;0.04028554;-0.08913581;-0.02978803;0.04435992;0.10622269;-0.00117773;-0.01223848;-0.05704984;-0.01365407;-0.04796998;-0.04279033;0.08857011;0.02246043;0.06857294;0.08986664;-0.03984360;-0.04789837;-0.09798230;0.04682006;0.00980560;-0.08953177;0.09313625;0.12111674;0.03666295;-0.02093368;-0.05124805;-0.05105155;-0.05745910;0.08788950;0.07988935;-0.07041710;0.00609928;0.14052811;-0.01722891;-0.03275155;0.00611320;0.00842331;0.02425998;-0.00251132;0.00822730;0.01908730;-0.03014264;-0.01968395;0.00333585;0.07314644;0.02741394;0.02289930;-0.00008813;-0.06037412;-0.07363812;0.01820531;0.04838610;-0.06923821;-0.06182897;-0.09876604;0.02309519;0.03525233;0.08318366;-0.02588224;0.01349018;0.07574301;-0.09226104;-0.08549239;-0.01913922;-0.07721350;-0.00741965;-0.00474780;0.02659055;0.03429880;0.05117430;0.00729922;-0.06137095;0.02008647;0.03990207;0.04452838;-0.03115167;-0.03198376;-0.06104296;0.03447195;0.01691870;-0.05390608;0.05192143;0.08279493;-0.02651136;-0.01688771;0.02113759;0.02455603;0.03767670;-0.03430504;-0.02187948;0.04077149;-0.02353580;-0.06477586;0.04765507;0.07142463;-0.02590382;-0.03055102;-0.06901962;0.02443300;-0.00160410;-0.05895314;0.07162176;0.07605460;0.00452753;0.01484083;-0.00044827;-0.00033465;-0.00708110;-0.00496926;-0.00796146;-0.00273231;0.01276083;-0.00039893;0.07774102;0.15156475;-0.02569671;-0.03654640;-0.10900395;0.00787745;-0.04136635;-0.08492936;0.13826511;0.08446196;0.00793033;-0.01321890;-0.01828292;-0.01517828;-0.01564354;0.02704387;0.02877951;-0.01752854;-0.00221542;0.04276677;-0.01958677;-0.06759777;-0.00477453;-0.00122737;0.02644311;0.02476469;0.04132003;0.01154293;-0.05434026;0.00977429;];
n = 10;
N = 100;
Y = reshape(data,n, N);
%b
b = mean(Y, 2);
%Z
Z = Y - b * ones([1, N]);
%SVD
[U, Sigma, V] = svd(Z, 0);
tmp = diag(Sigma)
m = 3;
Sigmam = diag(tmp(1: 3))
%A, X
A = U(:, 1:m) * Sigmam / sqrt(N);
X = V(:, 1:m)' * sqrt(N);
X * ones(N, 1)
1 / N * X * X'
%res
res = Z - A * X;
Norm = zeros([1, N]);
for i = 1:N
    Norm(i) = norm(res(:, i));
end
Norm = sort(Norm, 'descend');
plot(Norm)
