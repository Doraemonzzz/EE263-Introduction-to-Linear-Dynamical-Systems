% Data for rational interpolation problem
N = 100;
x = (-1.10:2.20/99.00:1.10)'; 
y =[ -1.27719297028879 ; -1.20223801678190 ; -1.12673937505085 ; -1.05020368610360 ; -0.97208264580456 ; -0.89176210724857 ; -0.80855082554005 ; -0.72166984536396 ; -0.63024445137407 ; -0.53330212321615 ; -0.42978237282232 ; -0.31856807864482 ; -0.19855332099210 ; -0.06876973111691 ; 0.07139926876572 ; 0.22188341692459 ; 0.38144684216989 ; 0.54708368387579 ; 0.71340000000000 ; 0.87224608096006 ; 1.01301738052188 ; 1.12403457965533 ; 1.19503330273391 ; 1.22005023144744 ; 1.19938301158301 ; 1.13953201143719 ; 1.05115028973971 ; 0.94612769010043 ; 0.83512795222308 ; 0.72626387464500 ; 0.62485173599151 ; 0.53381944669323 ; 0.45434781854303 ; 0.38648483390653 ; 0.32962629350210 ; 0.28284891891186 ; 0.24512145748988 ; 0.21542811135634 ; 0.19283430128223 ; 0.17651700313074 ; 0.16577470688974 ; 0.16002660882976 ; 0.15880692823542 ; 0.16175785832151 ; 0.16862321586177 ; 0.17924403183024 ; 0.19355690973606 ; 0.21159583322115 ; 0.23349815304833 ; 0.25951569197069 ; 0.29003227274115 ; 0.32558952476525 ; 0.36692360585353 ; 0.41501654818559 ; 0.47116735028712 ; 0.53708964552006 ; 0.61504442233060 ; 0.70801657734015 ; 0.81993929947466 ; 0.95595022587169 ; 1.12260167304441 ; 1.32777978859740 ; 1.57967259765502 ; 1.88322588235294 ; 2.23109080821588 ; 2.58594930330923 ; 2.86038405721985 ; 2.92882682461517 ; 2.71282625770910 ; 2.27171018117644 ; 1.75780066851098 ; 1.29405756340312 ; 0.92785333333333 ; 0.65711238574553 ; 0.46262023072442 ; 0.32424758510648 ; 0.22589523837886 ; 0.15585442101325 ; 0.10590944107180 ; 0.07035343001176 ; 0.04521343142709 ; 0.02770081722145 ; 0.01583662302596 ; 0.00819939779088 ; 0.00375553982771 ; 0.00174442504389 ; 0.00159989328879 ; 0.00289599004101 ; 0.00530903072395 ; 0.00859076407319 ; 0.01254916727166 ; 0.01703454873187 ; 0.02192938400005 ; 0.02714080632891 ; 0.03259500510762 ; 0.03823300940200 ; 0.04400748685773 ; 0.04988029379439 ; 0.05582058591975 ; 0.06180335091530];

% 初始化
m = 1;
X1 = x;

while 1
    X1 = [X1, x .* X1(:, m)];
    X2 = - diag(y) * X1;
    X = [ones(N, 1), X1, X2];
    m = m + 1;
    % 判断
    res = (rank(X) == rank([X, y]));

    if res
        break
    end
end

m

%计算结果
c = X \ y;
a = c(1: m + 1)
b = c(m + 2: 2 * m + 1)