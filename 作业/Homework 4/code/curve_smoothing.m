n = 51;
f =  1/20*[-59.1511  -56.1064  -50.2748  -49.4777  -37.8666  -39.1663  -29.5690  -23.1988  -13.5347  -19.0507  -13.5943   -3.3281    4.3185   -0.8454   -5.2978   -4.2539   -4.8049    3.4295   -7.6252   -2.9975   -7.9095  -10.6627   -3.6029    2.1732   -8.9521   -3.4540    3.6084    9.1472    3.9546    6.3898   13.0362    2.7332   13.4027   10.6478    0.9049    5.0750    6.0504   -0.6255    0.9780   -2.9543   -2.8318   -1.5979   -3.5722    1.1280    8.8262  18.4649   15.2587   30.3260   23.3266   34.6998   28.5653];

% 矩阵D
D1 = [eye(n - 2), zeros(n - 2, 2)];
D2 = [zeros(n - 2, 1), eye(n - 2), zeros(n - 2, 1)];
D3 = [zeros(n - 2, 2), eye(n - 2)];
D = D1 + D3 - 2 * D2;

% 作出不同的mu
% mu = 0
mu = 0;
g1 = (eye(n) + mu * n ^ 5 / (n - 2) * (D' * D)) \ f';

% mu = 1e-10
mu = 1e-10;
g2 = (eye(n) + mu * n ^ 5 / (n - 2) * (D' * D)) \ f';

% mu = 1e-3
mu = 1e-3;
g3 = (eye(n) + mu * n ^ 5 / (n - 2) * (D' * D)) \ f';

% mu = infty
A = [(1:n)', ones(n, 1)];
coef = A \ f';
g4 = A * coef;

% 作图
figure(1);
hold;
plot(f, '*');
plot(g1, '--');
plot(g2, '-.');
plot(g3, '-');
plot(g4, '--rs');
axis tight;
legend('f','u = 0', 'u = 10e-10', 'u = 10e-3', 'u = infinity', 'location', 'SouthEast');

% 权衡曲线
m = 30;
Mu = logspace(-8, -3, m);
x = zeros(m+2, 1);
y = zeros(m+2, 1);

x(1) = norm(f' - g1) ^ 2 / n;
y(1) = norm(D * g1) ^ 2 * n ^ 4 / (n - 2);
for i = 1: m
    mu = Mu(i);
    g = (eye(n) + mu * n ^ 5 / (n - 2) * (D' * D)) \ f';
    x(i+1) = norm(f' - g) ^ 2 / n;
    y(i+1) = norm(D * g) ^ 2 * n ^ 4 / (n - 2);
end

x(m+2) = norm(f' - g4) ^ 2 / n;
y(m+2) = norm(D * g4) ^ 2 * n ^ 4 / (n - 2);

figure(2)
plot(x, y);
